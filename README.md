# RESO CALC LOG COMPARE TOOL


### Что в данном коммите:

* Практически полностью реализованный REST на клиенте. Я принимаю параметры запроса (id), отправляю через параметры с GET-запросом на сервер, на сервере обрабатываю, отбираю по id нужные премии (пока тестовые), выплевываю назад, на клиенте принимаю, выплевываю в дочерний компонент, отображаю.
* Начал приводить схему к фабричному паттерну как в предыдущей логике. То есть по сути пошел процесс приведения к рабочей версии бизнес-логике и подхода к основным расчетам.
* Оказалось, что Hibernate все очень долго считал. Сначала я по глупости пытался прикрутить StoredProc, кстати, время было потрачено не впустую, я понял, что Хибернейтом можно без проблем дергать хранимые процедуры. Единственное что, оракл не передает РекордСеты в REF CURSOR (как выяснилось), не известно правда - такое только с процедурами или и с функциями тоже (как я понял, у других БД таких проблем нет, тем более в других БД нет проблем вообще заморачиваться с REF CURSOR, если можно сразу таблицу передать), но как вариант, можно таблу вытащить по кускам или json'ом, а на сервере собрать, хоть это уже и костыли. Короче, хоть я время и не зря на это потратил, в итоге я просто добавил индексы на calcid и вместо 2 минут все стало считать 3 мс (подробности добавления индексов ниже).
* Реализовать на сервере абстрактную фабрику, первую конкретную фабрику, основной метод. Теперь кидаемся не энтити, а сразу хэшмепами. Отпала необходимость во всяких методах типа getWebRowset и прочее. Получаю данные, пихаю в "сравнилку", сравниваю, выплевываю в консоль.


### Правки по таблицам:

Добавление индексов:

```
-- Создадим индекс для таблицы --
CREATE INDEX ws_calc_logs_new_temp_id ON WS_CALC_LOGS_NEW_TEMP_COPY(CALCID);
```

### Схема предыдущей версии RCLCT:
![screenshot](image.png)

Данная схема располагалась в "типа-либе" Reso-Calc-Log-PSHAPOVAL-Library. И класс мейн, а точнее его метод getResult уже дергался из веб-сервиса RCL. Схему данного проекта изложу в следующем коммите.


### Что надо будет сделать в следующем коммите:

* Возможности http://localhost:8083/RCCT-2.0-SNAPSHOT/rest/v3?id1=2&id2=7 добавить в http://localhost:8083/RCCT-2.0-SNAPSHOT/rest/v2 (то есть сделать как бэ новый метод). То есть нам надо теперь передавать с клиента реальные calcid, реально сравнивать, реально выплевывать объект, реально принимать его на сервере.
* Причесать код. Провести все чикины, убрать лишнее, прописать доки и каменты.
* Продумать / почитать / добавить везде юнит-тесты. Тот маленький функционал на сервере, что пока есть, хорошо бы тестануть на все, что можно: нули, слишком большие значения, отрицательные, отсутствующие и прочее. 












